"use strict";!function(e){e.cart_main=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"",t=document.createElement("div");t.setAttribute("id","cart_container"),t.innerHTML='\n    <div class="top">\n        <ul>\n            <li></li>\n            <li class="active">\n                <a href="###">\n                    <h4>全部商品</h4>\n                    <span>'+e+'</span>\n                </a>\n            </li>\n        </ul>\n        <p>已选商品（不含运费）<span>0.00</span><a href="javascript:;">结算</a></p>\n    </div>\n\n    <ul class="info">\n        <li>\n            <label style="background-position-y: 0;">\n                <input type="checkbox" />\n            </label>\n            全选\n        </li>\n        <li>商品信息</li>\n        <li>单价</li>\n        <li>数量</li>\n        <li>小计</li>\n        <li>操作</li>\n    </ul>\n\n    <div class="content"> <article><section></section></article></div>\n\n    <div class="close">\n        <ul>\n            <li>\n                <label>\n                    <input type="checkbox" />\n                </label>\n                <a href="javascript:void;">全选</a>\n            </li>\n            <li><a href="javascript:;">删除</a></li>\n            <li><a href="javascript:;">移入收藏夹</a></li>\n            <li><a href="javascript:;">分享</a></li>\n        </ul>\n        <div>\n            <div>\n                <span>已选商品</span><strong>0</strong><span>件</span>\n            </div>\n            <div>\n                <span>合计（不含运费）：</span><strong>0.00</strong>\n                <a href="javascript:;">结算</a>\n            </div>\n        </div>\n    </div>',document.querySelector(".shopcart").appendChild(t)},e.cart_init=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,i=function(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{},n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null,i={img:"img",desInfo:"desInfo",price:"price",type:"type",store:"store",goodsId:"goodsId"};Object.assign(i,t);var l='<section>\n                            <label style="background-position-y: 0;">\n                                <input type="checkbox" data-id="'+this[i.goodsId]+'" />\n                            </label>\n                            <ul>\n                                <li>\n                                    <a href="#">\n                                        <img src='+this[i.img]+' alt="" />\n                                    </a>\n                                    <a href="#">\n                                        <p>\n                                            '+this[i.desInfo]+"\n                                        </p>\n                                    </a>\n                                </li>\n                                <li>"+(this[i.type]?this[i.type]:"")+"</li>\n                                <li>&yen;<span>"+this[i.price]+'</span></li>\n                                <li>\n                                    <input type="button" value="" disabled style="cursor: no-drop;" /><input type="text" value="'+(null===n?1:n[this[i.goodsId]])+'" /><input type="button" value="+" />\n                                </li>\n                                <li>&yen;<span>'+this[i.price]+'</span></li>\n                                <li>\n                                    <a href="javascript:void(0);">移入收藏夹</a>\n                                    <a href="javascript:void(0);">删除</a>\n                                    <a href="javascript:void(0);" style="display: none;">相似宝贝</a>\n                                </li>\n                            </ul>\n                        </section>';e.innerHTML+=l},l=document.querySelector("#cart_container>.content>article>section");JSON.parse(e).forEach(function(e){i.call(e,l,t,n)})},e.cart_bind=function(i){document.querySelectorAll('input[type="checkbox"]').forEach(function(e){e.addEventListener("click",function(e){e.preventDefault()})});var l=document.querySelector("#cart_container"),e=(l.querySelector(".top>ul span"),l.querySelectorAll(".content>article")),t=l.querySelectorAll(".content>article>section>section"),n=l.querySelector(".close>div>div:first-of-type>strong"),r=l.querySelector(".top>p>span"),a=l.querySelector(".close>div>div:last-of-type>strong"),c=l.querySelector(".close>ul>li:nth-of-type(2)"),o=0;function s(e,t){(t||e).firstElementChild.checked?(e.firstElementChild.checked=!1,e.matches("#cart_container>.content>article>section label")&&"-20px"===e.style.backgroundPositionY&&p("-",Number(e.nextElementSibling.children[4].firstElementChild.innerHTML)),e.style.backgroundPositionY="0"):(e.firstElementChild.checked=!0,e.matches("#cart_container>.content>article>section label")&&"0px"===e.style.backgroundPositionY&&p("+",Number(e.nextElementSibling.children[4].firstElementChild.innerHTML)),e.style.backgroundPositionY="-20px")}function u(e,t,n){t?(e.style.cursor="no-drop",e.value="",e.disabled=!0):(e.style.cursor="pointer",e.value=n,e.disabled=!1)}function d(e,t){var n=parseInt(e.parentElement.previousElementSibling.firstElementChild.innerHTML);e.parentElement.nextElementSibling.firstElementChild.innerHTML=n*t}function p(e,t){"+"===e?(n.innerHTML=""+ ++o,r.innerHTML=""+(Number(r.innerHTML)+t),a.innerHTML=r.innerHTML,0<Number(a.innerHTML)&&(r.nextElementSibling.style.backgroundColor="#ff6600",a.nextElementSibling.style.backgroundColor="#ff6600")):(n.innerHTML=""+--o,r.innerHTML=""+(Number(r.innerHTML)-t),a.innerHTML=r.innerHTML,0===Number(a.innerHTML)&&(r.nextElementSibling.style.backgroundColor="",a.nextElementSibling.style.backgroundColor=""))}l.addEventListener("mouseup",function(t){"LABEL"===t.target.nodeName&&(t.target.matches("#cart_container>.info label")?l.querySelectorAll(".content label,.close label").forEach(function(e){s(e,t.target)}):t.target.matches("#cart_container>.close label")?l.querySelectorAll(".info label,.content label").forEach(function(e){s(e,t.target)}):t.target.matches("#cart_container>.content header>label")&&t.target.parentElement.nextElementSibling.querySelectorAll("label").forEach(function(e){s(e,t.target)}),s(t.target))}),l.addEventListener("click",function(e){var t=[];if(e.target.matches("#cart_container>.content>article>section>section li:last-of-type>a:nth-of-type(2)")){var n=e.target.parentElement.parentElement.parentElement;n.querySelector('input[type="checkbox"]').checked&&p("-",Number(e.target.parentElement.previousElementSibling.firstElementChild.innerHTML)),n.matches("#cart_container>.content>article>section>section:only-child")?l.querySelector(".content").removeChild(n.parentElement.parentElement):n.parentElement.removeChild(n),t.push(n.querySelector('input[type="checkbox"]').dataset.id),i(t)}}),e.forEach(function(e){e.addEventListener("click",function(e){if(e.target.matches('#cart_container>.content>article>section>section input[type="button"]:first-of-type')){var t=e.target.nextElementSibling,n=parseInt(t.value),i=Number(t.getAttribute("data-store"));switch(!0){case 2===n:e.target.style.cursor="no-drop",e.target.value="",e.target.disabled=!0;break;case n===i:e.target.parentElement.lastElementChild.style.cursor="pointer",e.target.parentElement.lastElementChild.value="+",e.target.parentElement.lastElementChild.disabled=!1}t.value=--n,d(t,n)}if(e.target.matches('#cart_container>.content>article>section>section input[type="button"]:last-of-type')){var l=e.target.previousElementSibling,r=parseInt(l.value);switch(!0){case r===Number(l.getAttribute("data-store"))-1:e.target.style.cursor="no-drop",e.target.value="",e.target.disabled=!0;break;case 1===r:e.target.parentElement.firstElementChild.style.cursor="pointer",e.target.parentElement.firstElementChild.value="-",e.target.parentElement.firstElementChild.disabled=!1}l.value=++r,d(l,r)}})}),t.forEach(function(e,t){e.querySelector('input[type="text"]').addEventListener("focus",function(){var e=this,t=Number(this.value),n=t;this.oninput=function(){var e=Number(this.value.trim());"number"==typeof e&&e%1==0&&0<e&&(t=e),this.value=t,d(this,t),t===STORE?(u(this.parentElement.firstElementChild,!1,"-"),u(this.parentElement.lastElementChild,!0,"+")):(1===t?u(this.parentElement.firstElementChild,!0,"-"):1===n&&u(this.parentElement.firstElementChild,!1,"-"),u(this.parentElement.lastElementChild,!1,"+"))},this.onblur=function(){e.oninput=null}})}),t.forEach(function(e){e.addEventListener("mousemove",function(){e.querySelector("section>ul>li:last-child>a:last-child").style.display="block"},!1),e.addEventListener("mouseout",function(){e.querySelector("section>ul>li:last-child>a:last-child").style.display="none"},!1)}),c.addEventListener("click",function(){var t=[];l.querySelectorAll(".content>article>section>section").forEach(function(e){e.querySelector('input[type="checkbox"]').checked&&(p("-",Number(e.lastElementChild.children[4].firstElementChild.innerHTML)),e.matches("#cart_container>.content>article>section>section:only-child")?l.querySelector(".content").removeChild(e.parentElement.parentElement):e.parentElement.removeChild(e),t.push(e.querySelector('input[type="checkbox"]').dataset.id))}),l.querySelector(".info label").firstElementChild.checked=!1,l.querySelector(".info label").style.backgroundPositionY="0",l.querySelector(".close label").firstElementChild.checked=!1,l.querySelector(".close label").style.backgroundPositionY="0",i(t)})}}(void 0);